schemaVersion: 2.0.0

# File existence tests
fileExistenceTests:
  - name: 'Application directory exists'
    path: '/app'
    shouldExist: true

  - name: 'Application code exists'
    path: '/app/app'
    shouldExist: true

  - name: 'Main application file exists'
    path: '/app/app/main.py'
    shouldExist: true

# Command tests  
commandTests:
  - name: 'Python version'
    command: 'python'
    args: ['--version']
    expectedOutput: ['Python 3.11']

  - name: 'Non-root user'
    command: 'whoami'
    expectedOutput: ['appuser']

  - name: 'FastAPI import test'
    command: 'python'
    args: ['-c', 'import fastapi; print("FastAPI imported successfully")']
    expectedOutput: ['FastAPI imported successfully']

  - name: 'Uvicorn import test'
    command: 'python'
    args: ['-c', 'import uvicorn; print("Uvicorn imported successfully")']
    expectedOutput: ['Uvicorn imported successfully']

  - name: 'Application module import'
    command: 'python'
    args: ['-c', 'from app.main import app; print("App imported successfully")']
    expectedOutput: ['App imported successfully']

# Metadata tests
metadataTest:
  exposedPorts: ['8000']
  user: 'appuser'